{% extends "dashboard_base.html" %}
{% load static %}

{% block sheri %}

<div class="container p-4">
    {% comment %} <div class="alert alert-warning" role="alert">
    Ø£Ù‡Ù„Ø§Ù‹ {{ request.user.username }} ğŸ‘‹ØŒ Ù‡Ø§ÙŠ Ù„Ù…Ø­Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù† Ø§Ø³ØªØ«Ù…Ø§Ø±Ùƒ Ø§Ù„ÙŠÙˆÙ…
    </div> {% endcomment %}


  <div class="bg-white p-3 rounded shadow-sm text-body-secondary mb-3 col-sm-6 col-md-8 mx-auto ">
    <div class="dropdown d-flex align-items-center justify-content-between">
      
      <!-- Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù†Ù‚Ø± Ù„ÙØªØ­ Dropdown -->
      <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" 
         data-bs-toggle="dropdown" aria-expanded="false">
        {% if user.profile.img_base64 %}
          <img src="{{user.profile.img_base64}}" alt="" width="46" height="46" class="rounded-circle me-2">
        {% else %}
          <img src="{% static 'img/profile_default/default-profile-img-2.png' %}" alt="" width="46" height="46" class="rounded-circle me-2">
        {% endif %}
        <div class="text-start">
          <p class="mb-1 text-dark fw-bold text-wrap">{{ request.user.username }}</p>
          <span class="bg-primary rounded d-inline px-2 py-1 text-white">{{request.user.profile.balance|floatformat:2 }}$</span>
        </div>
      </a>

      <!-- Ø²Ø± Ù…Ù†ÙØµÙ„ -->
      <a href="{% url 'Logout' %}" class="bg-body-tertiary btn btn-light px-2 py-1 ms-2">
        <i class="bi bi-door-open-fill"></i>
      </a>

      <!-- Ù‚Ø§Ø¦Ù…Ø© Dropdown -->
      <ul class="dropdown-menu dropdown-menu-dark shadow">
        <li><a class="dropdown-item" href="{% url 'my_devices' %}">Ø§Ø¨Ø¯Ø§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†...</a></li>
        <li><a class="dropdown-item" href="{% url 'EditProfile' %}">Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{% url 'Logout' %}">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a></li>
      </ul>
      
    </div>
  </div>




    <h5 class="mt-4">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h5>
    <div class=" mt-3 row row-cols-4 justify-content-center justify-content-md-between"  >

        <div class="col card rounded-4 bg-primary me-2 p-2 mt-2 text-white" style="width: 10rem;">
            <div class="card-body">
                <h6 class="card-subtitle mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h6>
                <h2 class="mt-4">
                    <i class="bi bi-hdd-stack-fill"></i>
                    {{my_devices.count}} Ø¬Ù‡Ø§Ø²
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
            </div>
        </div>
        <div class="col card rounded-4 bg-success me-2 p-2 mt-2" style="width: 10rem;">
            <div class="card-body text-white">
                <h6 class="card-subtitle mb-2 ">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h6>
                <h2 class="mt-4 ">
                    <i class="bi bi-cart-check-fill"></i>
                    {{daily_earning|floatformat:2}} $
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
                {% comment %} last order <strong>3 days ago</strong> {% endcomment %}
            </div>
        </div>
        <div class="col card rounded-4 bg-success-subtle me-2 p-2 mt-2" style="width: 10rem;">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-body-secondary">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h6>
                <h2 class="mt-4">
                    <i class="bi bi-stop-fill text-body-secondary"></i>
                    {{monthly_earning|floatformat:2}} $
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
            </div>
        </div>


        <div class="col card rounded-4 bg-dark me-2 p-2 mt-2" style="width: 10rem;">
            <div class="card-body text-white">
                <h6 class="card-subtitle mb-2 ">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¬Ù‡Ø²Ø©</h6>
                <h2 class="mt-4">
                    {% comment %} <i class="bi bi-stop-fill"></i> {% endcomment %}
                    Ø´ØºØ§Ù„ {{only_runing_devices.count}} âœ… 
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
            </div>
        </div>

        
    </div>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹ÙˆØ© -->
{% if user.is_authenticated %}
<div class="container py-3 text-center">
  <h2 class="mb-4 fs-5">ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</h2>
  <div class="bg-light p-4 rounded shadow-sm">
    <h3 class="text-primary" id="inviteCode">{{ user.profile.invite_code }}</h3>
    {% comment %} <p>Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ ÙˆØ´Ø§Ø±ÙƒÙ‡ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ¢Øª Ø¹Ù†Ø¯ Ø§Ù†Ø¶Ù…Ø§Ù…Ù‡Ù….</p> {% endcomment %}
    <button onclick="copyCode()" class="btn btn-outline-primary mt-2">
      <i class="fa-solid fa-copy"></i> Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯
    </button>
  </div>
</div>
<script>
function copyCode() {
  var code = document.getElementById("inviteCode").innerText;
  navigator.clipboard.writeText(code);
  alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­!");
}
</script>
{% endif %}
<!-- Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¯Ø¹ÙˆØ© -->



<!-- Ù…Ø¤Ø´Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ø±ÙŠ ÙˆØ«Ø§Ø¨Øª -->
<div id="online-indicator" class="position-fixed end-0 m-4" style="bottom: 50px;">
  <div class="rounded-circle bg-success text-white d-flex flex-column align-items-center justify-content-center shadow"
       style="width: 100px; height: 100px;">
    <div id="onlineCount" class="fw-bold fs-4">300</div>
    <div class="fs-6" style="font-size: 12px;">Ù…Ø³ØªØ®Ø¯Ù…</div>
    <div class="fs-6" style="font-size: 12px;">Ù…ØªØµÙ„</div>
  </div>
</div>

<!-- Ø³ÙƒØ±Ø¨Øª Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù‚Ù… -->
<script>
  function updateCounter() {
    const min = 280;
    const max = 320;
    const count = Math.floor(Math.random() * (max - min + 1)) + min;
    document.getElementById('onlineCount').textContent = count;
  }

  setInterval(updateCounter, 3000); // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 3 Ø«ÙˆØ§Ù†Ù
</script>



{% comment %} 
<canvas id="earningsChart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('earningsChart').getContext('2d');
const labels = [{% for record in monthly_records %}'{{ record.date }}',{% endfor %}];
const data = [{% for record in monthly_records %}{{ record.earned|floatformat:2 }},{% endfor %}];

new Chart(ctx, {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
            data: data,
            borderColor: 'rgba(75, 192, 192, 1)',
            fill: false,
        }]
    },
    options: {
        scales: {
            y: { beginAtZero: true }
        }
    }
});
</script> {% endcomment %}


{% comment %} <div class="container p-4 ">
    <h5>Last Orders</h5>

    <div class="tabel-box">

        <table class="table">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">ID</th>
                <th scope="col">Project name</th>
                <th scope="col">Service</th>
                <th scope="col">Service progress</th>
                <th scope="col">Status</th>
                <th scope="col">Subscription</th>
                <th scope="col">Scope</th>
                <th scope="col">Option</th>
              </tr>
            </thead>
            <tbody>
              {% for order in orders|slice:4 %}
              <tr>
                <th scope="row">1</th>
                <td>{{order.orderID}}</td>
                <td>{{order.user_service.project_name}}</td>
                <td>{{order.user_service.service.title}}</td>
                <td><span class="bg-primary px-2 py-1 rounded text-nowrap">{{order.user_service.get_progress_display}}</span></td>
                <td><span class="bg-primary px-2 py-1 rounded">{{order.get_progress_display}}</span></td>
                <td>{{order.title}}</td>
                <td><span class="bg-primary px-2 py-1 rounded">{{order.get_progress_paid_plan_scope_display}}</span></td>
                <td>
                  {% if order.progress == '1' %}
                  <a href="{% url 'ServicePayment' order.orderID %}" class="btn btn-success">Continue</a>
                  {% elif order.progress == '2' %}
                  <a href="{% url 'UpgradeOrRenewServiceSubscription' order.orderID %}" class="btn btn-success">Use</a>
                  {% endif %}
                  <a href="{% url 'DeleteOrder' order.orderID %}" class="btn btn-danger">Delete</a>
                </td>
              </tr>
              {% endfor %}
  
            </tbody>
          </table>
        </div>
</div> {% endcomment %}


{% endblock sheri %}