{% extends "dashboard_base.html" %}

{% block sheri %}

<div class="container p-4">
    {% comment %} <div class="alert alert-warning" role="alert">
    Ø£Ù‡Ù„Ø§Ù‹ {{ request.user.username }} ðŸ‘‹ØŒ Ù‡Ø§ÙŠ Ù„Ù…Ø­Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù† Ø§Ø³ØªØ«Ù…Ø§Ø±Ùƒ Ø§Ù„ÙŠÙˆÙ…
    </div> {% endcomment %}

    <h5>Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h5>
    <div class="py-3 row row-cols-4 justify-content-center justify-content-md-between"  >

        <div class="col card rounded-4 bg-primary me-2 p-2 mt-2 text-white" style="width: 10rem;">
            <div class="card-body">
                <h6 class="card-subtitle mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h6>
                <h2 class="mt-4">
                    <i class="bi bi-hdd-stack-fill"></i>
                    {{my_devices.count}} Ø¬Ù‡Ø§Ø²
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
            </div>
        </div>
        <div class="col card rounded-4 bg-success me-2 p-2 mt-2" style="width: 10rem;">
            <div class="card-body text-white">
                <h6 class="card-subtitle mb-2 ">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h6>
                <h2 class="mt-4 ">
                    <i class="bi bi-cart-check-fill"></i>
                    {{daily_earning|floatformat:2}} $
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
                {% comment %} last order <strong>3 days ago</strong> {% endcomment %}
            </div>
        </div>
        <div class="col card rounded-4 bg-success-subtle me-2 p-2 mt-2" style="width: 10rem;">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-body-secondary">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h6>
                <h2 class="mt-4">
                    <i class="bi bi-stop-fill text-body-secondary"></i>
                    {{monthly_earning|floatformat:2}} $
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
            </div>
        </div>


        <div class="col card rounded-4 bg-dark me-2 p-2 mt-2" style="width: 10rem;">
            <div class="card-body text-white">
                <h6 class="card-subtitle mb-2 ">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¬Ù‡Ø²Ø©</h6>
                <h2 class="mt-4">
                    {% comment %} <i class="bi bi-stop-fill"></i> {% endcomment %}
                    Ø´ØºØ§Ù„ {{only_runing_devices.count}} âœ… 
                </h2>
                Ø§Ø®Ø± ØªØ­Ø¯ÙŠØ« <strong>Ø§Ù„Ø§Ù†</strong>
            </div>
        </div>

        
    </div>
</div>




<canvas id="earningsChart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('earningsChart').getContext('2d');
const labels = [{% for record in monthly_records %}'{{ record.date }}',{% endfor %}];
const data = [{% for record in monthly_records %}{{ record.earned|floatformat:2 }},{% endfor %}];

new Chart(ctx, {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
            data: data,
            borderColor: 'rgba(75, 192, 192, 1)',
            fill: false,
        }]
    },
    options: {
        scales: {
            y: { beginAtZero: true }
        }
    }
});
</script>


{% comment %} <div class="container p-4 ">
    <h5>Last Orders</h5>

    <div class="tabel-box">

        <table class="table">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">ID</th>
                <th scope="col">Project name</th>
                <th scope="col">Service</th>
                <th scope="col">Service progress</th>
                <th scope="col">Status</th>
                <th scope="col">Subscription</th>
                <th scope="col">Scope</th>
                <th scope="col">Option</th>
              </tr>
            </thead>
            <tbody>
              {% for order in orders|slice:4 %}
              <tr>
                <th scope="row">1</th>
                <td>{{order.orderID}}</td>
                <td>{{order.user_service.project_name}}</td>
                <td>{{order.user_service.service.title}}</td>
                <td><span class="bg-primary px-2 py-1 rounded text-nowrap">{{order.user_service.get_progress_display}}</span></td>
                <td><span class="bg-primary px-2 py-1 rounded">{{order.get_progress_display}}</span></td>
                <td>{{order.title}}</td>
                <td><span class="bg-primary px-2 py-1 rounded">{{order.get_progress_paid_plan_scope_display}}</span></td>
                <td>
                  {% if order.progress == '1' %}
                  <a href="{% url 'ServicePayment' order.orderID %}" class="btn btn-success">Continue</a>
                  {% elif order.progress == '2' %}
                  <a href="{% url 'UpgradeOrRenewServiceSubscription' order.orderID %}" class="btn btn-success">Use</a>
                  {% endif %}
                  <a href="{% url 'DeleteOrder' order.orderID %}" class="btn btn-danger">Delete</a>
                </td>
              </tr>
              {% endfor %}
  
            </tbody>
          </table>
        </div>
</div> {% endcomment %}


{% endblock sheri %}